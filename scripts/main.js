"use strict";!function(){var t="https://api.instagram.com/v1/users/self/media/liked?",a="https://api.instagram.com/v1/users/self/media/recent/?",o="https://api.instagram.com/v1/media/",e="",i={};i.lookup={},i.sorted=[];var n=function(){var t="";i.sorted.map(function(a){var o='data-id="'+a.id+'"',e='src="'+a.profile_picture+'"',i='alt="'+a.username+'"',n='title="'+a.username+'"';t+='<div class="img-cont"><img '+o+" "+e+" "+i+" "+n+"></div>"}),$(".liked-grid").html(t),$(".img-cont").addClass("animated fadeIn")},r=function(){var t=i.lookup,a=i.sorted;for(var o in t)a.push(t[o]);a.sort(function(t,a){return t.totalLiked<a.totalLiked?1:t.totalLiked>a.totalLiked?-1:0})},d=function(t){return Promise.resolve($.ajax({method:"GET",dataType:"jsonp",url:t}))},s=function(t){return t.forEach(function(t){t.data.forEach(function(t){i.lookup[t.id]?i.lookup[t.id].totalLikedBack+=1:(t.totalLiked=0,t.totalLikedBack=1,i.lookup[t.id]=t)})}),t},l=function(t){var a=t.data,i=a.map(function(t){var a=o+t.id+"/likes/?"+e;return d(a)});return Promise.all(i).then(function(a){return a.next_url=t.pagination.next_url,a})["catch"](function(t){return console.log("catch err",t),t})},c=function(t){d(t).then(l).then(s).then(function(t){var a=t.next_url;c(a)})["catch"](function(){$("#overlay").modal("hide"),console.log("done!",i)})},u=function(t){var a=t.data;return a.forEach(function(t){var a=i.lookup,o=t.user;o.totalLiked=a[o.id]?a[o.id].totalLiked+=1:1,o.totalLikedBack=0,a[o.id]=o}),t},h=function(t){d(t).then(u).then(function(t){var a=t.pagination.next_url;h(a)})["catch"](function(){$("#overlay h1").text("Almost there..."),r(),n(),a+=e,c(a)})},k=function(){$("#overlay").modal("show"),$(".marketing").toggleClass("removed"),$(".main").toggleClass("removed"),$(".dashboard").toggleClass("removed").addClass("animated fadeIn"),$(".header").addClass("animated fadeIn")},f=function(){window.location.hash&&(e=window.location.hash.substr(1),t+=e,h(t))},m=function(){var t=$(this).attr("data-id"),a=i.lookup[t],o=a.totalLiked+a.totalLikedBack,e=Math.round(a.totalLiked/o*100)+"%",n=Math.round(a.totalLikedBack/o*100)+"%";$(".total-likes p").text(o),$(".your-likes p").text(a.totalLiked),$(".their-likes p").text(a.totalLikedBack),$(".their-likes h2").text(a.username+" Likes"),$(".progress-bar-success").css("width",e),$(".progress-bar-danger").css("width",n)};window.onhashchange=f(),$(".liked-grid").on("click","img",m),window.location.hash?(e=window.location.hash.substr(1),k()):(window.location.hash=" ",$(".marketing").addClass("animated fadeIn"))}();