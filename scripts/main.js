"use strict";!function(a){var t="https://api.instagram.com/v1/users/self/media/liked?",o="https://api.instagram.com/v1/users/self/media/recent/?",e="https://api.instagram.com/v1/media/",i="",n={};n.lookup={},n.sorted=[];var d=function(){var t="";n.sorted.map(function(a){var o='data-id="'+a.id+'"',e='src="'+a.profile_picture+'"',i='alt="'+a.username+'"',n='title="'+a.username+'"';t+='<div class="img-cont"><img '+o+" "+e+" "+i+" "+n+"></div>"}),a(".liked-grid").html(t),a(".img-cont").addClass("animated fadeIn")},r=function(){var a=n.lookup,t=n.sorted;for(var o in a)t.push(a[o]);t.sort(function(a,t){return a.totalLiked<t.totalLiked?1:a.totalLiked>t.totalLiked?-1:0})},s=function(t){return Promise.resolve(a.ajax({method:"GET",dataType:"jsonp",url:t}))},l=function(a){return a.forEach(function(a){a.data.forEach(function(a){n.lookup[a.id]?n.lookup[a.id].totalLikedBack+=1:(a.totalLiked=0,a.totalLikedBack=1,n.lookup[a.id]=a)})}),a},c=function(a){var t=a.data,o=t.map(function(a){var t=e+a.id+"/likes/?"+i;return s(t)});return Promise.all(o).then(function(t){return t.next_url=a.pagination.next_url,t})["catch"](function(a){return console.log("catch err",a),a})},u=function(t){s(t).then(c).then(l).then(function(a){var t=a.next_url;u(t)})["catch"](function(){a("#overlay").modal("hide"),console.log("done!",n)})},h=function(a){var t=a.data;return t.forEach(function(a){var t=n.lookup,o=a.user;o.totalLiked=t[o.id]?t[o.id].totalLiked+=1:1,o.totalLikedBack=0,t[o.id]=o}),a},f=function(t){s(t).then(h).then(function(a){var t=a.pagination.next_url;f(t)})["catch"](function(){a("#overlay h1").text("Almost there..."),r(),d(),g(),o+=i,u(o)})},k=function(){a("#overlay").modal("show"),a(".marketing").toggleClass("removed"),a(".main").toggleClass("removed"),a(".dashboard").toggleClass("removed").addClass("animated fadeIn"),a(".liked-grid").toggleClass("removed").addClass("animated fadeIn"),a(".header").toggleClass("removed").addClass("animated fadeIn"),a(".footer").addClass("animated fadeIn")},m=function(){window.location.hash&&(i=window.location.hash.substr(1),t+=i,f(t))},p=function(){var t=a(this).attr("data-id"),o=n.lookup[t],e=o.totalLiked+o.totalLikedBack,i=Math.round(o.totalLiked/e*100)+"%",d=Math.round(o.totalLikedBack/e*100)+"%";a(".total-likes p").text(e),a(".your-likes p").text(o.totalLiked),a(".their-likes p").text(o.totalLikedBack),a(".their-likes h2").text(o.username+" Likes"),a(".progress-bar-success").css("width",i),a(".progress-bar-danger").css("width",d)},g=function(){var t=a(".dashboard-wrapper").width(),o=a(".dashboard").height();a(".dashboard").width(t),a(".dashboard-wrapper").height(o)};a(".liked-grid").on("click","img",p),a(window).resize(g),a(".dashboard").on("affix.bs.affix",g),window.onhashchange=m(),window.location.hash?(i=window.location.hash.substr(1),k()):(window.location.hash=" ",a(".marketing").addClass("animated fadeIn"),a(".footer").addClass("animated fadeIn")),a(".dashboard").affix({offset:{top:a(".dashboard").offset().top}})}(window.jQuery);